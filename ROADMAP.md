# OpenTypeless 开发规划

> 1:1 复刻 [Typeless](https://www.typeless.com/) 的开源 macOS 应用

## 项目概述

OpenTypeless 是一款 AI 驱动的语音输入助手，让用户可以在任何应用中通过语音快速输入、重写和翻译文本。

---

## 进度总览

| 阶段 | 状态 | 完成度 |
|------|------|--------|
| 阶段 1：基础架构 | 🔲 待开始 | 0% |
| 阶段 2：语音转文字 | 🔲 待开始 | 0% |
| 阶段 3：AI 智能处理 | 🔲 待开始 | 0% |
| 阶段 4：高级功能 | 🔲 待开始 | 0% |

状态图例：🔲 待开始 | 🔨 进行中 | ✅ 已完成

---

## 阶段 1：基础架构

**目标**：搭建 macOS 菜单栏应用的基本框架

| 任务 | 状态 | 备注 |
|------|------|------|
| 1.1 创建 Xcode 项目 | 🔲 | Swift + SwiftUI |
| 1.2 菜单栏应用 (Menu Bar App) | 🔲 | NSStatusItem |
| 1.3 全局快捷键监听 | 🔲 | fn 键特殊处理 |
| 1.4 设置界面 UI | 🔲 | 快捷键、语言、账户 |
| 1.5 历史记录界面 UI | 🔲 | 列表展示 |

### 技术细节
- **框架**：Swift 5.9+ / SwiftUI
- **最低支持**：macOS 13.0+
- **快捷键库**：HotKey 或 Carbon API

---

## 阶段 2：语音转文字

**目标**：实现基础的语音识别和文字输入功能

| 任务 | 状态 | 备注 |
|------|------|------|
| 2.1 麦克风权限请求 | 🔲 | Info.plist 配置 |
| 2.2 音频录制模块 | 🔲 | AVAudioEngine |
| 2.3 语音识别集成 | 🔲 | Apple Speech / Whisper |
| 2.4 获取当前光标位置 | 🔲 | Accessibility API |
| 2.5 文字插入功能 | 🔲 | 模拟键盘输入 |
| 2.6 实时转录显示 | 🔲 | 浮动窗口 |

### 技术细节
- **语音识别**：优先使用 Apple Speech Framework（离线），备选 Whisper API
- **权限**：需要麦克风权限 + 辅助功能权限

---

## 阶段 3：AI 智能处理

**目标**：接入 LLM 实现智能格式化、重写、翻译

| 任务 | 状态 | 备注 |
|------|------|------|
| 3.1 LLM API 集成 | 🔲 | OpenAI / Claude |
| 3.2 智能格式化 | 🔲 | 列表、邮件、电话号码等 |
| 3.3 获取选中文本 | 🔲 | Accessibility API |
| 3.4 文本重写功能 | 🔲 | 选中 + 语音指令 |
| 3.5 翻译功能 | 🔲 | 弹窗显示结果 |
| 3.6 结果替换/插入 | 🔲 | 替换选中文本 |

### 技术细节
- **API 选择**：支持配置 OpenAI / Claude / 本地模型
- **Prompt 设计**：针对不同场景优化提示词

---

## 阶段 4：高级功能

**目标**：完善用户体验和个性化功能

| 任务 | 状态 | 备注 |
|------|------|------|
| 4.1 历史记录存储 | 🔲 | SQLite / CoreData |
| 4.2 历史记录管理 | 🔲 | 搜索、删除、导出 |
| 4.3 个人词典 | 🔲 | 自动学习 + 手动添加 |
| 4.4 多语言自动检测 | 🔲 | 语言识别 |
| 4.5 免提模式 | 🔲 | 持续监听 |
| 4.6 音频保存/回放 | 🔲 | 可选功能 |

---

## 核心功能对照

| Typeless 功能 | OpenTypeless | 状态 |
|---------------|--------------|------|
| 语音转文字 | ✓ 计划实现 | 🔲 |
| 智能格式化 | ✓ 计划实现 | 🔲 |
| 文本重写 | ✓ 计划实现 | 🔲 |
| 翻译功能 | ✓ 计划实现 | 🔲 |
| 多应用适配 | ✓ 计划实现 | 🔲 |
| 历史记录 | ✓ 计划实现 | 🔲 |
| 个人词典 | ✓ 计划实现 | 🔲 |
| 多语言支持 | ✓ 计划实现 | 🔲 |

---

## 快捷键设计

| 操作 | 快捷键 | 说明 |
|------|--------|------|
| 语音输入 | `fn` 按住 | 按住说话，释放插入 |
| 免提模式 | `fn` + `Space` | 持续监听 |
| 翻译模式 | `fn` + `←` | 翻译选中文本 |
| 停止录音 | `Esc` | 取消当前操作 |

---

## 项目结构

```
OpenTypeless/
├── OpenTypeless.xcodeproj    # Xcode 项目
├── OpenTypeless/
│   ├── App/                  # 应用入口
│   ├── Views/                # SwiftUI 视图
│   ├── Services/             # 核心服务
│   │   ├── AudioService      # 音频录制
│   │   ├── SpeechService     # 语音识别
│   │   ├── AIService         # LLM 集成
│   │   └── AccessibilityService  # 辅助功能
│   ├── Models/               # 数据模型
│   ├── Utils/                # 工具类
│   └── Resources/            # 资源文件
├── ui_to_learn/              # 参考截图
├── logs/                     # 日志
└── ROADMAP.md                # 本文件
```

---

## 更新日志

### 2026-02-09
- 创建项目规划文档
- 完成功能调研和分析
- 确定技术栈和开发阶段

---

## 下一步

开始 **阶段 1：基础架构**
- [ ] 创建 Xcode 项目
- [ ] 实现菜单栏应用基础框架
